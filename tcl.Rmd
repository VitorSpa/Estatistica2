---
title: "Teorema Central do Limite"
---

## TCL {.tabset .tabset-fade}

### Introdução

O Teorema Central do Limite nos mostra que a média de n elementos de uma população tende à uma distribuição normal.

Seja uma amostra aleatória $(X_{1}, X_{2}, ..., X_{n})$ de uma distribuição de $E(X) = \mu$ e Variância $\sigma^2$ temos que:

$E(\bar{X}) = \mu$ e $Var(\bar{X}) = \frac{\sigma^2}{n}$

Vamos demonstrar então o teorema de forma empírica tirando diversas amostras de diferentes distribuições discretas e contínuas.

Serão criadas amostras dos seguintes tamanhos:

$n = 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 75, 100, 250, 500, 1000$

```{r}
sampleSizes <- c(5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 75, 100, 250, 500, 1000)
```

Para cada tamanho serão geradas 1000 amostras. Totalizando mil médias de cada tamanho de amostra para cada distribuição.

```{r}
nSamples <- 1000
```


### Distribuições Discretas {.tabset .tabset-fade}

#### Bernoulli {.tabset .tabset-fade}

A distribuição de Bernoulli tem parâmetro $p$ e apresenta:

$X \sim Bern(p)$

$E(X) = p$ e $Var(X) = p(1-p)$

##### Para $p = 0.5$ 

Teríamos então $E(\bar{X}) = 0.5$ e $Var(\bar{X}) = \frac{0.25}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rbinom(size, 1, 0.5)))
  }
  print(c("Tamanho da amostra:", size))
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### Para $p = 0.7$ 

Teríamos então $E(\bar{X}) = 0.7$ e $Var(\bar{X}) = \frac{0.25}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rbinom(size, 1, 0.7)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

#### Binomial {.tabset .tabset-fade}

A distribuição de Bernoulli tem parâmetros $n$ e $p$ e apresenta:

$X \sim Binom(n,p)$

$E(X) = np$ e $Var(X) = np(1-p)$

##### $n = 5$ e $p = 0.5$ 

Teríamos então $E(\bar{X}) = 2.5$ e $Var(\bar{X}) = \frac{1.25}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rbinom(size, 5, 0.5)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### $n = 10$ e $p = 0.3$

Teríamos então $E(\bar{X}) = 3$ e $Var(\bar{X}) = \frac{2.1}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rbinom(size, 10, 0.3)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

#### Geométrica {.tabset .tabset-fade}

A distribuição Geométrica tem parâmetros $n$ e $p$ e apresenta:

$X \sim Geom(n, p)$

$E(X) = \frac{1-p}{p}$ e $Var(X) = \frac{1-p}{p^2}$

##### $p = 0.5$

Teríamos então $E(\bar{X}) = 1$ e $Var(\bar{X}) = \frac{2}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean((rgeom(size, 0.5))))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### $p = 0.85$

Teríamos então $E(\bar{X}) = 0.1765$ e $Var(\bar{X}) = \frac{2.1}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rgeom(size, 0.85)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

#### Poisson {.tabset .tabset-fade}

A distribuição de Poisson tem parâmetros $\lambda$ e apresenta:

$X \sim Poisson(\lambda)$

$E(X) = \lambda$ e $Var(X) = \lambda$

##### Para $\lambda = 4$ 

Teríamos então $E(\bar{X}) = 4$ e $Var(\bar{X}) = \frac{4}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rpois(size, 4)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### Para $\lambda = 6$ 

Teríamos então $E(\bar{X}) = 6$ e $Var(\bar{X}) = \frac{6}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rpois(size, 6)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

### Distribuições Contínuas {.tabset .tabset-fade}

#### Uniforme {.tabset .tabset-fade}

A distribuição Uniforme tem parâmetro $a$ e $b$ e apresenta:

$X \sim Uniforme(a,b)$

$E(X) = \frac{1}{2}(a+b)$ e $Var(X) = \frac{1}{12}(b-a)^2$

##### Para $a = 0$ e $b = 3$

Teríamos então $E(\bar{X}) = 1.5$ e $Var(\bar{X}) = \frac{7.5}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(runif(size, min = 0, max = 3)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### Para $a = 1$ e $b = 5$

Teríamos então $E(\bar{X}) = 3$ e $Var(\bar{X}) = \frac{1.3333}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(runif(size, min = 1, max = 5)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

#### Normal {.tabset .tabset-fade}

A distribuição Normal tem parâmetros $\mu$ e $\sigma^2$ e apresenta:

$X \sim Normal(\mu,\sigma^2)$

$E(X) = \mu$ e $Var(X) = \sigma^2$

##### Para $\mu = 5$ e $\sigma^2 = 1.5$

Teríamos então $E(\bar{X}) = 5$ e $Var(\bar{X}) = \frac{1.5}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rnorm(size, mean = 5, sd = sqrt(1.5))))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```


##### Para $\mu = 110$ e $\sigma^2 = 20$

Teríamos então $E(\bar{X}) = 110$ e $Var(\bar{X}) = \frac{20}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rnorm(size, mean = 110, sd = sqrt(20))))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```


#### Exponencial {.tabset .tabset-fade}

A distribuição Exponencial tem parâmetro $\lambda$ e apresenta:

$X \sim Exp(\lambda)$

$E(X) = \frac{1}{\lambda}$ e $Var(X) = \frac{1}{\lambda^2}$

##### Para $\lambda = 5$

Teríamos então $E(\bar{X}) = 0.2$ e $Var(\bar{X}) = \frac{0.04}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rexp(size, rate = 5)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### Para $\lambda = 15$

Teríamos então $E(\bar{X}) = 0.066667$ e $Var(\bar{X}) =\frac{0.0004444}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rexp(size, rate = 15)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

#### t-Student {.tabset .tabset-fade}

A distribuição t-Student tem parâmetro $\nu = n-1$ e apresenta:

$X \sim Exp(\lambda)$

$E(X) = 0$ e $Var(X) = \frac{\nu}{\nu-2}$

##### Para $\nu = 11$

Teríamos então $E(\bar{X}) = 0$ e $Var(\bar{X}) = \frac{1.222222}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rt(size, 11, ncp = 0)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### Para $\nu = 25$

Teríamos então $E(\bar{X}) = 0$ e $Var(\bar{X}) = \frac{1.086957}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rt(size, 25, ncp = 0)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

#### chi-Quadrado {.tabset .tabset-fade}

A distribuição chi-Quadrado tem parâmetro $k$ e apresenta:

$X \sim \chi^2(K)$

$E(X) = K$ e $Var(X) = 2K$

##### Para $K = 3$

Teríamos então $E(\bar{X}) = 3$ e $Var(\bar{X}) = \frac{6}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rchisq(size, 3, ncp=0)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### Para $K = 10$

Teríamos então $E(\bar{X}) = 10$ e $Var(\bar{X}) = \frac{20}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rchisq(size, 10, ncp=0)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

#### Fisher-Snedecor {.tabset .tabset-fade}

A distribuição F de Fisher-Snedecor tem parâmetros $d_{1}$ e $d_{2}$ e apresenta:

$X \sim F(d_{1},d_{2})$

$E(X) = \frac{d_{2}}{d_{2}-2}$ e $Var(X) = \frac{2d_{2}^2(d_{1}+d_{2}-2)}{d_{1}(d_{2}-2)^2(d_{2}-4)}$

##### Para $d_{1}= 9 $ e $d_{2}= 5$ 

Teríamos então $E(\bar{X}) = 1.66667$ e $Var(\bar{X}) = \frac{7.407407}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rf(size, 9, 5, ncp = 0)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

##### Para $d_{1}= 15 $ e $d_{2}= 6$ 

Teríamos então $E(\bar{X}) = 1.5$ e $Var(\bar{X}) = \frac{2.85}{n}$

```{r}
bernMeans <- NULL
bernVars <- NULL
plot_list <- NULL

for (size in sampleSizes){
  aux <- NULL
  for(i in 1:1000){
  aux <- c(aux, mean(rf(size, 15, 6, ncp = 0)))
  }
  myMean <- mean(aux)
  myVar <- var(aux)
  bernMeans <- c(bernMeans, myMean)
  bernVars  <- c(bernVars, myVar)
  plot_list <- c(plot_list, hist(aux, main = c("Media: ", myMean, "Var: ", myVar), xlab = "Média", ylab = "Freq", col = "darkgrey"))
}  
```

### Conclusão

Como podemos observar, o resultado condiz com a teoria e tanto o valor esperado quanto a variância se aproximam do valor previsto pelo teorema.
